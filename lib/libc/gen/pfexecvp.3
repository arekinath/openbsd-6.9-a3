.\" Copyright 2021, the University of Queensland
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.Dd $Mdocdate: October 1 2021 $
.Dt PFEXECVP 3
.Os
.Sh NAME
.Nm pfexecvp ,
.Nm pfexecvpe
.Nd execute a file with elevated privileges
.Sh SYNOPSIS
.In sys/pfexec.h
.Ft int
.Fn pfexecvp "const struct pfexecve_opts *opts" "const char *file" "char *const argv[]"
.Ft int
.Fn pfexecvpe "const struct pfexecve_opts *opts" "const char *file" "char *const argv[]" "char *const envp[]"
.Sh DESCRIPTION
This family of functions request elevated privileges from the system and then
replace the current process image with a new process image.
The functions described in this manual page are front-ends for the
.Xr pfexecve 2
system call; see that manual page for detailed information
about the elevation process and replacement of the current process.
.Pp
The second argument for these functions is the pathname of a file which
is to be executed. These functions duplicate the actions of the shell in
searching for an executable file if the specified file name does not contain
a slash
.Pq Sq \&/
character.
The search path is the path specified in the environment by
.Ev PATH
variable.
If this variable isn't specified,
.Dv _PATH_DEFPATH
from
.In paths.h
is used instead, its value being:
.Pa /usr/bin:/bin:/usr/sbin:/sbin:/usr/X11R6/bin:/usr/local/bin
.Sh RETURN VALUES
If any of these functions return, an error has occurred.
The return value is \-1, and the global variable
.Va errno
will be set to indicate the error.
.Sh ERRORS
.Fn pfexecvp
and
.Fn pfexecvpe
may fail and set
.Va errno
for any of the errors specified for the library functions
.Xr pfexecve 2
and
.Xr malloc 3 .
.Sh SEE ALSO
.Xr sh 1 ,
.Xr pfexecve 2 ,
.Xr execve 2,
.Xr execv 3
.Xr environ 7
